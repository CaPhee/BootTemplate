<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
<title>Google Map Hello World Example</title>
<style type="text/css">
div#map{
	width: 100%;
	height: 350px;
}
</style>
</head>
<body>
    <div id="map"></div>
    <script type="text/javascript" th:inline="javascript">
    /*<![CDATA[*/
      function initMap() {
        var map = new google.maps.Map(document.getElementById('map'), {
          center: {lat: 16.054856,lng:108.200403},
          zoom: 12
        });
        var busStations = /*[[${busStations}]]*/ ;
        console.log(busStations);
        //var i;
        //var marker;
        for (let i = 0; i < busStations.length; i++) {
            var latLng = new google.maps.LatLng(busStations[i].latitude, busStations[i].longitude);
            let marker = new google.maps.Marker({
                position: latLng
                , title: busStations[i].name
            });
            let infowindow = new google.maps.InfoWindow({
                content: busStations[i].name + '<div>' + '<input type="button" value="xe dang den"/>' + '</div>'
            });
            marker.setMap(map);
            google.maps.event.addListener(marker, 'click', function () {
                if (!marker.open) {
                    infowindow.open(map, marker);
                    marker.open = true;
                }
                else {
                    infowindow.close();
                    marker.open = false;
                }
                google.maps.event.addListener(map, 'click', function () {
                    infowindow.close();
                    marker.open = false;
                });
            });
        }
        
    }
      /*]]>*/
    </script>
    
    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCv7lDkj6Yd3cMbujJcHTKIo_AzLEga-7c&amp;callback=initMap"
    async="async" defer="defer"></script>
  </body>
</html>